{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\ahmed\\\\OneDrive\\\\Desktop\\\\easy_cars\\\\frontend\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$();\nimport { createContext, useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(localStorage.getItem(\"token\"));\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Load user on initial render\n  useEffect(() => {\n    const loadUser = async () => {\n      if (token) {\n        setAuthToken(token);\n        try {\n          const res = await axios.get(\"/api/auth/profile\");\n          setUser(res.data.data);\n          setIsAuthenticated(true);\n        } catch (err) {\n          var _err$response, _err$response$data;\n          localStorage.removeItem(\"token\");\n          setToken(null);\n          setUser(null);\n          setIsAuthenticated(false);\n          setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Authentication failed\");\n        }\n      }\n      setLoading(false);\n    };\n    loadUser();\n  }, [token]);\n\n  // Set token in headers\n  const setAuthToken = token => {\n    if (token) {\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n      localStorage.setItem(\"token\", token);\n    } else {\n      delete axios.defaults.headers.common[\"Authorization\"];\n      localStorage.removeItem(\"token\");\n    }\n  };\n\n  // Register user\n  const register = async formData => {\n    try {\n      const res = await axios.post(\"/api/auth/register\", formData);\n      setToken(res.data.token);\n      setUser(res.data.user);\n      setIsAuthenticated(true);\n      setLoading(false);\n      setError(null);\n      return res.data;\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      setError(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || \"Registration failed\");\n      throw err;\n    }\n  };\n\n  // Login user\n  const login = async formData => {\n    try {\n      const res = await axios.post(\"/api/auth/login\", formData);\n      setToken(res.data.token);\n      setUser(res.data.user);\n      setIsAuthenticated(true);\n      setLoading(false);\n      setError(null);\n      return res.data;\n    } catch (err) {\n      var _err$response3, _err$response3$data;\n      setError(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || \"Login failed\");\n      throw err;\n    }\n  };\n\n  // Logout user\n  const logout = () => {\n    setToken(null);\n    setUser(null);\n    setIsAuthenticated(false);\n    setError(null);\n  };\n\n  // Update user profile\n  const updateProfile = async formData => {\n    try {\n      const res = await axios.put(\"/api/users/update-profile\", formData);\n      setUser(res.data.data);\n      setError(null);\n      return res.data;\n    } catch (err) {\n      var _err$response4, _err$response4$data;\n      setError(((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.message) || \"Profile update failed\");\n      throw err;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      token,\n      isAuthenticated,\n      loading,\n      error,\n      register,\n      login,\n      logout,\n      updateProfile\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"uU6IHWeRkaaSwG/RGLZ7SdfFc98=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["_jsxFileName","_s","$RefreshSig$","createContext","useState","useEffect","axios","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","user","setUser","token","setToken","localStorage","getItem","isAuthenticated","setIsAuthenticated","loading","setLoading","error","setError","loadUser","setAuthToken","res","get","data","err","_err$response","_err$response$data","removeItem","response","message","defaults","headers","common","setItem","register","formData","post","_err$response2","_err$response2$data","login","_err$response3","_err$response3$data","logout","updateProfile","put","_err$response4","_err$response4$data","Provider","value","fileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/ahmed/OneDrive/Desktop/easy_cars/frontend/src/context/AuthContext.js"],"sourcesContent":["\"use client\"\r\n\r\nimport { createContext, useState, useEffect } from \"react\"\r\nimport axios from \"axios\"\r\n\r\nexport const AuthContext = createContext()\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null)\r\n  const [token, setToken] = useState(localStorage.getItem(\"token\"))\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false)\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState(null)\r\n\r\n  // Load user on initial render\r\n  useEffect(() => {\r\n    const loadUser = async () => {\r\n      if (token) {\r\n        setAuthToken(token)\r\n        try {\r\n          const res = await axios.get(\"/api/auth/profile\")\r\n          setUser(res.data.data)\r\n          setIsAuthenticated(true)\r\n        } catch (err) {\r\n          localStorage.removeItem(\"token\")\r\n          setToken(null)\r\n          setUser(null)\r\n          setIsAuthenticated(false)\r\n          setError(err.response?.data?.message || \"Authentication failed\")\r\n        }\r\n      }\r\n      setLoading(false)\r\n    }\r\n\r\n    loadUser()\r\n  }, [token])\r\n\r\n  // Set token in headers\r\n  const setAuthToken = (token) => {\r\n    if (token) {\r\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`\r\n      localStorage.setItem(\"token\", token)\r\n    } else {\r\n      delete axios.defaults.headers.common[\"Authorization\"]\r\n      localStorage.removeItem(\"token\")\r\n    }\r\n  }\r\n\r\n  // Register user\r\n  const register = async (formData) => {\r\n    try {\r\n      const res = await axios.post(\"/api/auth/register\", formData)\r\n\r\n      setToken(res.data.token)\r\n      setUser(res.data.user)\r\n      setIsAuthenticated(true)\r\n      setLoading(false)\r\n      setError(null)\r\n\r\n      return res.data\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || \"Registration failed\")\r\n      throw err\r\n    }\r\n  }\r\n\r\n  // Login user\r\n  const login = async (formData) => {\r\n    try {\r\n      const res = await axios.post(\"/api/auth/login\", formData)\r\n\r\n      setToken(res.data.token)\r\n      setUser(res.data.user)\r\n      setIsAuthenticated(true)\r\n      setLoading(false)\r\n      setError(null)\r\n\r\n      return res.data\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || \"Login failed\")\r\n      throw err\r\n    }\r\n  }\r\n\r\n  // Logout user\r\n  const logout = () => {\r\n    setToken(null)\r\n    setUser(null)\r\n    setIsAuthenticated(false)\r\n    setError(null)\r\n  }\r\n\r\n  // Update user profile\r\n  const updateProfile = async (formData) => {\r\n    try {\r\n      const res = await axios.put(\"/api/users/update-profile\", formData)\r\n\r\n      setUser(res.data.data)\r\n      setError(null)\r\n\r\n      return res.data\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || \"Profile update failed\")\r\n      throw err\r\n    }\r\n  }\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user,\r\n        token,\r\n        isAuthenticated,\r\n        loading,\r\n        error,\r\n        register,\r\n        login,\r\n        logout,\r\n        updateProfile,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}